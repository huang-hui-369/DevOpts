# jmeter的功能

jmeter以多线程的方式模拟多用户，并发运行Sample（测试脚本），对服务器进行测试，收集测试过程中结果ResponseAssertion，性能数据AggregateReport（响应时间，吞吐量），生成报表数据，分析系统性能.

## 工作原理

Jmeter工具和其他性能工具在原理上完全一致，工具包含以下四个部分

1. 模拟并发用户：通常以多线程的方式模拟用户行为。

2. 运行脚本：通常为http请求附加在线程上，根据脚本要求模拟指定的用户行为。

3. 被测服务器：

4. 报表生成器：根据测试采集的数据生成报表，提供可视化的数据显示方式。

## jmeter 常用测试元件

1. 测试计划：可以看成开发中的project，是其它 JMeter测试元件的容器

2. 线程组：代表一定数量的用户，它可以用来模拟用户并发发送请求。实际的请求内容在Sampler中定义，它被线程组包含。

3. 配置元件：维护Sampler需要的配置信息，用户定义的参数，并根据实际的需要修改请求的内容。

4. 前置处理器：负责在请求之前工作，常用来修改请求的设置

5. 定时器：负责定义请求之间的延迟间隔。

6. 取样器(Sampler)：是性能测试中向服务器发送请求，记录响应信息、响应时间的最小单元，如：HTTP Request Sampler、FTP Request Sample、TCP Request Sample、JDBC Request Sampler等，每一种不同类型的sampler 可以根据设置的参数向服务器发出不同类型的请求。

7. 后置处理器：负责在请求之后工作，常用获取返回的值, 如：正则表达式。

8. 断言：响应断言，通过对比服务器返回的响应数据，判断请求是否成功。

9. 监听器：负责收集测试结果，同时确定结果显示的方式，如：查看结果树

10. 逻辑控制器：可以自定义JMeter发送请求的行为逻辑，它与Sampler结合使用可以模拟复杂的请求序列。

## 元件执行顺序

配置元件->前置处理器->定时器->取样器->后置处理程序->断言->监听器

**注意事项：**

1.前置处理器、后置处理器和断言等组件只能对取样器起作用，因此，如果在它们的作用域内没有任何取样器，则不会被执行。

2.如果在同一作用域内有多个同一类型的元件，则这些元件按照它们在测试计划中的上下顺序依次执行。

配置元件->前置处理器->定时器->取样器->后置处理程序->断言->监听器

## Jmeter测试流程步骤

### 1. 新建测试计划
打开Jmeter，在菜单左侧出现 “测试计划”。在这里测试计划我们可以把它理解成新建的空白项目，在这个空白项目下面可以添加一系列的接口。

![](img\2021-04-16-11-40-06.png)


### 2. 添加线程组
1. 右键点击Test Plan->添加->线程(用户)->线程组。
![](img\2021-04-16-11-42-37.png)

2. 填写线程组信息
   
*    线程数：可以理解为并发用户数 50
*    Ramp-Up时间(秒)：设置并发用户数全部启动的时长。
*    执行多久可以通过执行次数或者执行时间来设置
     Loop count：每个线程执行次数(发送请求的次数)。
     Specify Thread lifetime： 执行时间来控制执行多久，需要将上面的Loop count 设置为infinite无限循坏， 同时填写下面的Duration。
        Duration（seconds）：
        Start up Delay（seconds）：
![](img\2021-04-16-11-45-14.png)

### 3. 添加HTTP Request Defaults 

1. 右键点击Test Plan->add->config element->添加HTTP Request Defaults。
![](img\2021-04-16-13-41-27.png)

2. 填写一些共通信息，如：server ip。。。
![](img\2021-04-16-13-44-11.png)

### 4. 添加HTTP Request Defaults 



### 命令行 运行jmeter
jmeter -n -t .\Thread-Group-search-shop.jmx  -l .\test005.log -e -o .\output5


